<div style="margin-top: 180px;">
  <div class="card-body" style="border-style: solid; border-color: #2e3047 ;
  background-color: #fff;">
<button class="btn btn-primary float-right" (click)="parentModal2.show();addEvent();">
  Ajouter exam
</button>
<div class="row text-center">
  <div class="col-md-4">
    <div class="btn-group">
      <div
        class="btn btn-primary"
        mwlCalendarPreviousView
        [view]="view"
        [(viewDate)]="viewDate"
        (viewDateChange)="closeOpenMonthViewDay()"
      >
        Precedent
      </div>
      <div
        class="btn btn-outline-secondary"
        mwlCalendarToday
        [(viewDate)]="viewDate"
      >
        Aujourd'hui
      </div>
      <div
        class="btn btn-primary"
        mwlCalendarNextView
        [view]="view"
        [(viewDate)]="viewDate"
        (viewDateChange)="closeOpenMonthViewDay()"
      >
        suivant
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <h3>  {{ viewDate | calendarDate:(view + 'ViewTitle'):locale:weekStartsOn }}</h3>
  </div>
  <div class="col-md-4">
    <div class="btn-group">
      <div
        class="btn btn-primary"
        (click)="setView(CalendarView.Month)"
        [class.active]="view === CalendarView.Month"
      >
       Mois
      </div>
      <div
        class="btn btn-primary"
        (click)="setView(CalendarView.Week)"
        [class.active]="view === CalendarView.Week"
      >
        Semaine
      </div>
      <div
        class="btn btn-primary"
        (click)="setView(CalendarView.Day)"
        [class.active]="view === CalendarView.Day"
      >
        Jour
      </div>
    </div>
  </div>
</div>
<br />
<div [ngSwitch]="view">
  <mwl-calendar-month-view
    *ngSwitchCase="CalendarView.Month"
    [viewDate]="viewDate"
    [events]="events"
    [refresh]="refresh"
    [locale]="locale"
    [activeDayIsOpen]="activeDayIsOpen"
    (dayClicked)="dayClicked($event.day)"
    (eventClicked)="handleEvent('Clicked', $event.event);show();"
    (eventTimesChanged)="eventTimesChanged($event)"
  >
  </mwl-calendar-month-view>
  <mwl-calendar-week-view
    *ngSwitchCase="CalendarView.Week"
    [viewDate]="viewDate"
    [events]="events"
    [refresh]="refresh"
    [locale]="locale"
    (eventClicked)="handleEvent('Clicked', $event.event);"
    (eventTimesChanged)="eventTimesChanged($event)"
  >
  </mwl-calendar-week-view>
  <mwl-calendar-day-view
    *ngSwitchCase="CalendarView.Day"
    [viewDate]="viewDate"
    [events]="events"
    [dayStartHour]="8"
    [dayEndHour]="19"
    [hourSegments]="4"
    [refresh]="refresh"
    [locale]="locale"
    (eventClicked)="handleEvent('Clicked', $event.event);"
    (eventTimesChanged)="eventTimesChanged($event)"
  >
  </mwl-calendar-day-view>
</div>
</div>
</div>
<!-- Tout ce que vous voyez ci-dessous est juste pour la démo, vous n'avez pas besoin de l'inclure dans votre application-->

<br /><br /><br />

<h3>
  Modifier les événements

  <div class="clearfix"></div>
</h3>

<div class="table-responsive">
  <table class="table table-bordered">
    <thead>
    <tr>
      <th>Titre</th>
      <th>Couleur primaire</th>
      <th>Commence à</th>
      <th>Fini à</th>
      <th>Action</th>
    </tr>
    </thead>

    <tbody>
    <tr *ngFor="let event of calendars">
      <td>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="event.title"
          (keyup)="refresh.next()"
        />
      </td>
      <td>
        <input
          type="color"
          [(ngModel)]="event.color"
          (change)="refresh.next()"
        />
      </td>
      <td>
        <input
          class="form-control"
          type="text"
          mwlFlatpickr
          [(ngModel)]="event.start"
          (ngModelChange)="refresh.next()"
          [altInput]="true"
          [convertModelValue]="true"
          [enableTime]="true"
          dateFormat="Y-m-dTH:i"
          altFormat="F j, Y H:i"
          placeholder="Not set"
        />
      </td>
      <td>
        <input
          class="form-control"
          type="text"
          mwlFlatpickr
          [(ngModel)]="event.end"
          (ngModelChange)="refresh.next()"
          [altInput]="true"
          [convertModelValue]="true"
          [enableTime]="true"
          dateFormat="Y-m-dTH:i"
          altFormat="F j, Y H:i"
          placeholder="Not set"
        />
      </td>
      <td>
        <button class="btn btn-danger" (click)="deleteEvent(event)">
          Supprimer
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<ng-template  #modalContent let-close="close">
  <div class="modal-header">
    <h5 class="modal-title">Event action occurred</h5>
    <button type="button" class="close" (click)="close()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div>
      Action:
      <pre>{{ modalData?.action }}</pre>
    </div>
    <div>
      Event:
      <pre>{{ modalData?.event | json }}</pre>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-secondary" (click)="close()">
      OK
    </button>
  </div>
</ng-template>


<div class="modal fade" bsModal #parentModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="dialog-nested-name1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="dialog-nested-name1" class="modal-title pull-left">Ajouter Departement</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="parentModal.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <input
          type="text"
          class="form-control"
          [(ngModel)]="event.title"
          (keyup)="refresh.next()"
        />
        <input
          type="color"
          [(ngModel)]="event.color.primary"
          (change)="refresh.next()"
        />
        <input
          type="color"
          [(ngModel)]="event.color.secondary"
          (change)="refresh.next()"
        />
        <input
          class="form-control"
          type="text"
          mwlFlatpickr
          [(ngModel)]="event.start"
          (ngModelChange)="refresh.next()"
          [altInput]="true"
          [convertModelValue]="true"
          [enableTime]="true"
          dateFormat="Y-m-dTH:i"
          altFormat="F j, Y H:i"
          placeholder="Not set"
        />
        <input
          class="form-control"
          type="text"
          mwlFlatpickr
          [(ngModel)]="event.end"
          (ngModelChange)="refresh.next()"
          [altInput]="true"
          [convertModelValue]="true"
          [enableTime]="true"
          dateFormat="Y-m-dTH:i"
          altFormat="F j, Y H:i"
          placeholder="Not set"
        />
        <div class="modal-body">
          <button class="btn btn-outline-danger pull-right" (click)="parentModal.hide();">Annuler</button>
          <button class="btn btn-outline-success pull-right" style="margin-right: 5px;" (click)="parentModal.hide(); addEvent();">Ajouter</button>
        </div>
      </div>
    </div>
  </div>
</div>


<!--Ajouter exam-->
<div class="modal fade" bsModal #parentModal2="bs-modal" tabindex="-1" role="dialog" aria-labelledby="dialog-nested-name1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="dialog-nested-name1" class="modal-title pull-left">Ajouter exam</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="parentModal2.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="row">
            <div class="col-md-7" style="margin-left: 140px;">
              <div class="form-group">
                <input   class="form-control" name="reference" placeholder="Reference" [(ngModel)]="exam.reference"
                         ngModel
                         required
                         #reference="ngModel"
                         [ngClass]="{'form-control' : true,
                'is-invalid' : !reference?.valid && reference?.touched,
                  'is-valid' : reference?.valid && reference?.touched}">
                <small *ngIf="reference?.errors?.required && reference?.touched"
                       class="form-text text-danger">champs obligatoire</small>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <input type="datetime-local" id="exam-time"
                       placeholder="dateDepart"
                       min="2020-01-01T00:00" max="2020-07-01T00:00"
                       class="form-control" name="dateDepart" [(ngModel)]="exam.dateDepart"
                       ngModel
                       required
                       #dateDepart="ngModel"
                       [ngClass]="{'form-control' : true,
                'is-invalid' : !dateDepart?.valid && dateDepart?.touched,
                  'is-valid' : dateDepart?.valid && dateDepart?.touched}">
                <small *ngIf="dateDepart?.errors?.required && dateDepart?.touched"
                       class="form-text text-danger">champs obligatoire</small>
              </div></div>
            <div class="col-md-6">
              <div class="form-group">
                <input type="datetime-local" id="exam-time"
                       min="2020-01-01T00:00" max="2020-07-01T00:00"
                       value="2020-05-12T19:30" class="form-control" name="dateFin"  [(ngModel)]="exam.dateFin"
                       ngModel
                       required
                       #dateFin="ngModel"
                       [ngClass]="{'form-control' : true,
                'is-invalid' : !dateFin?.valid && dateFin?.touched,
                  'is-valid' : dateFin?.valid && dateFin?.touched}">
                <small *ngIf="dateFin?.errors?.required && dateFin?.touched"
                       class="form-text text-danger">champs obligatoire</small>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <select class=" input-large form-control" name="prof" [(ngModel)]="exam.prof"
                        ngModel
                        required
                        #prof="ngModel"
                        [ngClass]="{'form-control' : true,
                'is-invalid' : !prof?.valid && prof?.touched,
                  'is-valid' : prof?.valid && prof?.touched}">
                  <option value="">--Choisir un prof--</option>
                  <option *ngFor="let prof of professeurs" [ngValue]="prof">{{prof.nom}}</option>
                </select>
                <small *ngIf="prof?.errors?.required && prof?.touched" class="form-text text-danger">champs obligatoire</small>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <select class=" input-large form-control" name="module" [(ngModel)]="exam.module"
                        ngModel
                        required
                        #module="ngModel"
                        [ngClass]="{'form-control' : true,
                'is-invalid' : !module?.valid && module?.touched,
                  'is-valid' : module?.valid && module?.touched}">
                  <option *ngFor="let module of modules" [ngValue]="module" >{{module.libelle}}</option>
                </select>
                <small *ngIf="module?.errors?.required && module?.touched" class="form-text text-danger">champs obligatoire</small>
              </div></div>
          </div>
          <div class="row">
            <div class="col-md-7" style="margin-left: 140px;">
              <div class="form-group" >
                <select class=" input-large form-control" name="surveillant" (change)="recupererSurv($event.target.value)"
                        ngModel
                        required
                        #surveillant="ngModel"
                        [ngClass]="{'form-control' : true,
                'is-invalid' : !surveillant?.valid && surveillant?.touched,
                  'is-valid' : surveillant?.valid && surveillant?.touched}" >

                  <option *ngFor="let surve of surveillants" [value]="surve.nom">{{surve.nom}}</option>
                </select>
                <small *ngIf="surveillant?.errors?.required && surveillant?.touched" class="form-text text-danger">champs obligatoire</small>
              </div></div>

            <div class="form-group">
              <button class="btn btn-info btn-sm fa fa-plus btn-block" type="button" (click)="addSurveillant(surveill)" style="height: 36px; margin-left: -15px; width: 40px;"></button>
            </div>

            <!-- debut liste d'ajout des surveillants-->
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <div class="card-header"><h6>La liste des Surveillants</h6></div>
                  <div class="table-responsive">
                    <table class="table" style="text-align: center;">
                      <thead>
                      <tr>
                        <th>Nom</th>
                        <th>Prenom</th>
                        <th>Email</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr *ngFor= "let surve of exam.examSurveillants">
                        <td>{{surve.surveillant.nom}}</td>
                        <td>{{surve.surveillant.prenom}}</td>
                        <td>{{surve.surveillant.mail}}</td>

                      </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- fin liste d'ajout des surveillants-->
          <br>
          <div class="row">
            <div class="col-md-7" style="margin-left: 140px;">
              <div class="form-group">
                <select class=" input-large form-control" name="salle"  (change)="recupererSalle($event.target.value)"
                        ngModel
                        required
                        #salle="ngModel"
                        [ngClass]="{'form-control' : true,
                'is-invalid' : !salle?.valid && salle?.touched,
                  'is-valid' : salle?.valid && salle?.touched}" >

                  <option *ngFor="let s of salles" [value]="s.designation">{{s.designation}}</option>
                </select>
                <small *ngIf="salle?.errors?.required && salle?.touched" class="form-text text-danger">champs obligatoire</small>
              </div>
            </div>
            <div class="form-group">
              <button class="btn btn-info btn-sm fa fa-plus btn-block" type="button" (click)="addSalle(sal)" style="height: 36px; margin-left: -15px; width: 40px;"></button>
            </div>
            <!-- debut liste d'ajout des salles-->
            <div class="col-md-12">

              <div class="card">
                <div class="card-body">
                  <div class="card-header"><h6>La liste des Salles</h6></div>
                  <div class="table-responsive">
                    <table class="table" style="text-align: center;">
                      <thead>
                      <tr>
                        <th>Designation</th>
                        <th>Capacite</th>
                        <th>Etat</th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr *ngFor= "let sa of exam.examSalles">
                        <td>{{sa.salle.designation}}</td>
                        <td>{{sa.salle.capacite}}</td>
                        <td>{{sa.salle.etat}}</td>

                      </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- fin liste d'ajout des salles-->
        </form>
        <div class="modal-body">
          <button class="btn btn-outline-danger pull-right" (click)="parentModal.hide();">Annuler</button>
          <button class="btn btn-outline-success pull-right" style="margin-right: 5px;" (click)="save();parentModal2.hide();addEvent()">Ajouter</button>
        </div>
      </div>
    </div>
  </div>
</div>

